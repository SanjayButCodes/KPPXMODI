<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KPPXMODI</title>

<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }

:root {
  --footer-height: 56px;
}

/* ===== BODY ===== */
body {
  margin: 0;
  height: 100vh;
  background: radial-gradient(circle at top, #0f2027, #000);
  overflow: hidden;
  color: #9ffcff;
}

/* ===== SCREENS ===== */
.screen {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: var(--footer-height);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 18px;
  opacity: 0;
  pointer-events: none;
  transform: scale(0.92);
  transition: all 0.45s ease;
}

.screen.active {
  opacity: 1;
  pointer-events: auto;
  transform: scale(1);
}

/* ===== TITLES ===== */
h1 {
  font-size: 42px;
  letter-spacing: 2px;
  text-shadow: 0 0 15px #00f7ff;
}

/* ===== POSTER ===== */
#poster {
  width: 220px;
  border-radius: 12px;
  box-shadow: 0 0 30px rgba(0,255,255,0.6);
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
  100% { transform: translateY(0); }
}

/* ===== BUTTONS ===== */
button {
  padding: 14px 30px;
  font-size: 18px;
  border-radius: 8px;
  border: 1px solid #00f7ff;
  background: rgba(0,255,255,0.08);
  color: #9ffcff;
  cursor: pointer;
  box-shadow: 0 0 12px rgba(0,255,255,0.4);
  transition: 0.25s ease;
}

button:hover {
  background: rgba(0,255,255,0.2);
  box-shadow: 0 0 22px rgba(0,255,255,0.9);
  transform: scale(1.05);
}

/* ===== INPUT ===== */
input {
  padding: 12px;
  font-size: 18px;
  border-radius: 6px;
  border: 1px solid #00f7ff;
  background: rgba(0,0,0,0.6);
  color: #9ffcff;
}

/* ===== CANVAS ===== */
canvas {
  background: #70c5ce;
  border-radius: 8px;
  box-shadow: 0 0 25px rgba(0,255,255,0.5);
}

/* ===== GAME OVER UI ===== */
#gameOverUI {
  margin-top: 14px;
  display: none;
  flex-direction: column;
  gap: 12px;
}

/* ===== FOOTER ===== */
#footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: var(--footer-height);
  background: rgba(0,0,0,0.85);
  border-top: 1px solid #00f7ff;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  z-index: 10;
}

#footer a {
  display: flex;
  align-items: center;
  gap: 8px;
  color: #9ffcff;
  text-decoration: none;
  font-size: 14px;
  letter-spacing: 1px;
  opacity: 0.85;
  transition: 0.25s ease;
}

#footer a:hover {
  opacity: 1;
  text-shadow: 0 0 10px #00f7ff;
}

#footer img {
  height: 22px;
  filter: drop-shadow(0 0 6px #00f7ff);
}
</style>
</head>

<body>

<!-- ===== MENU ===== -->
<div id="menu" class="screen active">
  <h1>KPPXMODI</h1>
  <img id="poster" src="poster.png" alt="Game Poster">
  <button onclick="goName()">‚ñ∂ Play</button>
  <button onclick="goLeaderboard()">üèÜ Leaderboard</button>
</div>

<!-- ===== NAME ===== -->
<div id="nameScreen" class="screen">
  <h1>Enter Pilot Name</h1>
  <input id="nameInput" placeholder="Your name">
  <button onclick="startGame()">Launch</button>
</div>

<!-- ===== LEADERBOARD ===== -->
<div id="leaderboardScreen" class="screen">
  <h1>Leaderboard</h1>
  <div id="leaderboardList"></div>
  <button onclick="goMenu()">‚¨Ö Back</button>
</div>

<!-- ===== GAME ===== -->
<div id="gameScreen" class="screen">
  <canvas id="game" width="400" height="600"></canvas>

  <div id="gameOverUI">
    <button onclick="restartGame()">üîÅ Restart</button>
    <button onclick="goMenu()">üè† Main Menu</button>
  </div>
</div>

<!-- ===== FOOTER ===== -->
<div id="footer">
  <a href="https://github.com/SanjayButCodes" target="_blank">
    <img src="github.png" alt="GitHub">
    <span>SanjayButCodes</span>
  </a>
</div>

<!-- ===== SCRIPT ===== -->
<script>
/* ===== SCREENS ===== */
const screens = { menu, name:nameScreen, leaderboard:leaderboardScreen, game:gameScreen };
function show(s){
  Object.values(screens).forEach(sc=>sc.classList.remove("active"));
  screens[s].classList.add("active");
}
function goMenu(){ show("menu"); }
function goName(){ show("name"); }
function goLeaderboard(){ renderLeaderboard(); show("leaderboard"); }

/* ===== PLAYER ===== */
let leaderboard = JSON.parse(localStorage.getItem("leaderboard")) || [];
let playerName="", playerHighScore=0;

/* ===== IMAGES ===== */
const birdImg=new Image(); birdImg.src="bird.png";
const pipeImg=new Image(); pipeImg.src="pillar.png";
const deathImg=new Image(); deathImg.src="death.png";
const jobImg=new Image(); jobImg.src="job.png";

/* ===== AUDIO ===== */
const flapSound=new Audio("click.mp3");
const dieSound=new Audio("die.mp3");
let currentSound=null;

/* ===== GAME VARS ===== */
let bird,pipes,frame,score,gameOver=false;
let easterEggTriggered=false;

/* ===== CANVAS ===== */
const canvas=game, ctx=canvas.getContext("2d");

/* ===== GAME FLOW ===== */
function startGame(){
  const n=nameInput.value.trim();
  if(!n) return;
  playerName=n;
  const e=leaderboard.find(x=>x.name===n);
  playerHighScore=e?e.score:0;
  resetGame();
  gameOverUI.style.display="none";
  show("game");
}

function resetGame(){
  bird={x:80,y:250,w:40,h:40,velocity:0,gravity:0.4,lift:-8,rotation:0};
  pipes=[]; frame=0; score=0;
  gameOver=false;
  easterEggTriggered=false;
}

function restartGame(){
  if(currentSound===dieSound) return;
  resetGame();
  gameOverUI.style.display="none";
}

/* ===== INPUT ===== */
document.body.addEventListener("click",()=>{
  if(!gameOver && screens.game.classList.contains("active")){
    bird.velocity=bird.lift;
    playSound(flapSound);
  }
});

/* ===== AUDIO ===== */
function playSound(s,f=false){
  if(currentSound&&!f) return;
  if(currentSound&&f) currentSound.pause();
  currentSound=s; s.currentTime=0; s.play();
  s.onended=()=>currentSound=null;
}

/* ===== PIPES ===== */
function addPipe(){
  const gap=190, top=Math.random()*220+60;
  pipes.push({x:400,top,bottom:top+gap,w:60,passed:false});
}

/* ===== LEADERBOARD ===== */
function saveScore(){
  const e=leaderboard.find(x=>x.name===playerName);
  if(e){ if(score>e.score) e.score=score; }
  else leaderboard.push({name:playerName,score});
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard=leaderboard.slice(0,5);
  localStorage.setItem("leaderboard",JSON.stringify(leaderboard));
  playerHighScore=Math.max(playerHighScore,score);
}

function renderLeaderboard(){
  leaderboardList.innerHTML=leaderboard.map(
    (e,i)=>`<div>${i+1}. ${e.name} ‚Äî ${e.score}</div>`
  ).join("");
}

/* ===== UPDATE ===== */
function update(){
  if(gameOver||!screens.game.classList.contains("active")) return;

  bird.velocity+=bird.gravity;
  bird.velocity*=0.98;
  bird.y+=bird.velocity;
  bird.rotation=Math.min(Math.max(bird.velocity*0.05,-0.5),1);

  if(frame%110===0) addPipe();
  frame++;

  pipes.forEach(p=>{
    p.x-=1.6;

    if(!p.passed && p.x+p.w<bird.x){
      score++; p.passed=true;

      // ü•ö Easter Egg at score 5
      if(score===5 && !easterEggTriggered){
        easterEggTriggered=true;
        gameOver=true;
        playSound(dieSound,true);
        saveScore();
        gameOverUI.style.display="flex";
      }
    }

    if(bird.x<p.x+p.w&&bird.x+bird.w>p.x&&(bird.y<p.top||bird.y+bird.h>p.bottom)){
      gameOver=true;
      playSound(dieSound,true);
      saveScore();
      gameOverUI.style.display="flex";
    }
  });
}

/* ===== DRAW ===== */
function draw(){
  if(!screens.game.classList.contains("active")) return;
  ctx.clearRect(0,0,400,600);

  pipes.forEach(p=>{
    ctx.drawImage(pipeImg,p.x,0,p.w,p.top);
    ctx.drawImage(pipeImg,p.x,p.bottom,p.w,600);
  });

  ctx.save();
  ctx.translate(bird.x+20,bird.y+20);
  ctx.rotate(bird.rotation);
  ctx.drawImage(birdImg,-20,-20,40,40);
  ctx.restore();

  ctx.fillStyle="#fff";
  ctx.font="18px Arial";
  ctx.fillText(`Score: ${score} | High: ${playerHighScore}`,12,24);

  if(easterEggTriggered){
    ctx.drawImage(jobImg,40,120,320,360);
  } else if(gameOver){
    ctx.drawImage(deathImg,50,200,300,200);
  }
}

function loop(){ update(); draw(); requestAnimationFrame(loop); }
loop();
</script>
</body>
</html>
